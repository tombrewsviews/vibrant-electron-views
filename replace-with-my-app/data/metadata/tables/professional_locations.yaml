---
table: professional_locations

#############
# relations #
#############
object_relationships:
  - name: professional
    using:
      foreign_key_constraint_on: professional_id
  - name: provider_location
    using:
      foreign_key_constraint_on: provider_location_id

###############
# permissions #
###############
# insert_permissions:
#   - role: company-admin
#     permission:
#       check:
#         &company-im-an-admin-of # location belongs to a company I'm an admin of
#         provider_location:
#           company_id:
#             _in: X-Hasura-Companies
#       columns:
#         - professional_id
#         - provider_location_id
#   - role: support
#     permission:
#       columns:
#         - professional_id
#         - provider_location_id
# select_permissions:
#   - role: company-admin
#     permission: &select_permissions:company-admin:permission
#       allow_aggregations: true
#       columns:
#         - professional_id
#         - provider_location_id
#       # TODO see this permission in the context of an admin choosing the
#       # location/professional for an employee. If we extend on this permission
#       # in a sensible way we will be able to keep on using the company-admin
#       # role instead of having to swap roles in the UI.
#       # If we were to change them, we'd need to restrict the update_permissions
#       # below
#       filter: *company-im-an-admin-of
#   - role: company-user
#     permission: *select_permissions:company-admin:permission
#   - role: member
#     permission: &select_permissions:member:permission
#       allow_aggregations: true
#       columns:
#         - professional_id
#         - provider_location_id
#   - role: public
#     permission: *select_permissions:member:permission
#   - role: support
#     permission: *select_permissions:member:permission
# update_permissions:
#   - role: company-admin
#     permission: *select_permissions:company-admin:permission
#   - role: support
#     permission:
#       columns:
#         - professional_id
#         - provider_location_id
# delete_permissions:
#   - role: company-admin
#     permission: *select_permissions:company-admin:permission
#   - role: support
#     permission:
#       filter: {}
